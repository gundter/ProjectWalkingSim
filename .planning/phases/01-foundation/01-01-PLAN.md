---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs
  - Source/ProjectWalkingSim/Public/Core/SereneGameInstance.h
  - Source/ProjectWalkingSim/Private/Core/SereneGameInstance.cpp
  - Source/ProjectWalkingSim/Public/Interaction/InteractableInterface.h
  - Source/ProjectWalkingSim/Private/Interaction/InteractableInterface.cpp
  - Source/ProjectWalkingSim/Public/Interaction/HideableInterface.h
  - Source/ProjectWalkingSim/Private/Interaction/HideableInterface.cpp
  - Source/ProjectWalkingSim/Public/Interaction/SaveableInterface.h
  - Source/ProjectWalkingSim/Private/Interaction/SaveableInterface.cpp
  - Source/ProjectWalkingSim/Public/Tags/SereneTags.h
  - Source/ProjectWalkingSim/Private/Tags/SereneTags.cpp
  - Source/ProjectWalkingSim/Public/Core/SereneLogChannels.h
  - Source/ProjectWalkingSim/Private/Core/SereneLogChannels.cpp
autonomous: true

must_haves:
  truths:
    - "Project compiles with EnhancedInput, UMG, GameplayTags, PhysicsCore, Slate modules"
    - "IInteractable interface declares GetInteractionText, CanInteract, OnInteract, OnFocusBegin, OnFocusEnd"
    - "IHideable interface compiles as a stub with CanHide, OnEnterHiding, OnExitHiding"
    - "ISaveable interface compiles as a stub with GetSaveId, WriteSaveData, ReadSaveData"
    - "Native gameplay tags compile and are usable from any file in the module"
    - "SereneGameInstance stores head-bob toggle and crouch mode settings"
  artifacts:
    - path: "Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs"
      provides: "Module dependencies for all Phase 1 systems"
      contains: "EnhancedInput"
    - path: "Source/ProjectWalkingSim/Public/Interaction/InteractableInterface.h"
      provides: "IInteractable contract"
      contains: "IInteractable"
    - path: "Source/ProjectWalkingSim/Public/Tags/SereneTags.h"
      provides: "Native gameplay tag declarations"
      contains: "UE_DECLARE_GAMEPLAY_TAG_EXTERN"
    - path: "Source/ProjectWalkingSim/Public/Core/SereneLogChannels.h"
      provides: "Log category for all phase 1 code"
      contains: "DECLARE_LOG_CATEGORY_EXTERN"
  key_links:
    - from: "ProjectWalkingSim.Build.cs"
      to: "All Phase 1 source files"
      via: "Module dependencies enabling #include"
      pattern: "EnhancedInput.*UMG.*GameplayTags.*PhysicsCore"
    - from: "SereneTags.h"
      to: "SereneTags.cpp"
      via: "UE_DECLARE/UE_DEFINE pairs"
      pattern: "UE_DEFINE_GAMEPLAY_TAG"
---

<objective>
Project scaffolding: Build.cs dependencies, core interfaces, gameplay tags, log channels, and game instance settings class.

Purpose: Every subsequent plan depends on module dependencies being correct, interfaces being declared, and tags being available. This is the foundation that unblocks all parallel work.

Output: Compilable project skeleton with all Phase 1 module dependencies, three UINTERFACE declarations (IInteractable fully specified, IHideable and ISaveable as stubs), native gameplay tags, a project log category, and a game instance class for user settings persistence.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/codebase/CONVENTIONS.md
@Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Build.cs and create project scaffolding directories</name>
  <files>
    Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs
    Source/ProjectWalkingSim/Public/Core/SereneLogChannels.h
    Source/ProjectWalkingSim/Private/Core/SereneLogChannels.cpp
    Source/ProjectWalkingSim/Public/Core/SereneGameInstance.h
    Source/ProjectWalkingSim/Private/Core/SereneGameInstance.cpp
  </files>
  <action>
    1. Update Build.cs to add all Phase 1 module dependencies:
       - PublicDependencyModuleNames: add "EnhancedInput", "UMG", "GameplayTags", "PhysicsCore"
       - PrivateDependencyModuleNames: add "Slate", "SlateCore"
       - Keep existing Core, CoreUObject, Engine, InputCore

    2. Create directory structure under Source/ProjectWalkingSim/:
       - Public/Core/, Private/Core/
       - Public/Player/, Private/Player/
       - Public/Player/Components/, Private/Player/Components/
       - Public/Player/HUD/, Private/Player/HUD/
       - Public/Interaction/, Private/Interaction/
       - Public/Tags/, Private/Tags/

    3. Create SereneLogChannels.h/.cpp:
       - Header: DECLARE_LOG_CATEGORY_EXTERN(LogSerene, Log, All);
       - Cpp: DEFINE_LOG_CATEGORY(LogSerene);
       - This is the single log category for all project code (not LogTemp)

    4. Create SereneGameInstance.h/.cpp (UGameInstance subclass):
       - UPROPERTY(Config, BlueprintReadWrite) bool bHeadBobEnabled = true;
       - UPROPERTY(Config, BlueprintReadWrite) bool bCrouchToggleMode = true; (true=toggle, false=hold)
       - UFUNCTION(BlueprintCallable) void SaveAccessibilitySettings();
       - UFUNCTION(BlueprintCallable) void LoadAccessibilitySettings();
       - Use USaveGame subclass (USereneSettingsSave) for persistence. Define it inline in the same files.
       - Override Init() to call LoadAccessibilitySettings()
       - Include SereneLogChannels.h header and use LogSerene for any logging

    Do NOT create player or component classes yet -- those are in Plan 02/03/04.
  </action>
  <verify>
    Build the project from command line or editor. All new files should compile without errors:
    - Run: UnrealBuildTool or open project in editor and build
    - Verify no missing module errors
    - Verify log category can be used: UE_LOG(LogSerene, Log, TEXT("Test"));
  </verify>
  <done>
    Build.cs has all Phase 1 dependencies. Directory structure exists. LogSerene category compiles. SereneGameInstance compiles with settings properties and save/load.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create core interfaces and native gameplay tags</name>
  <files>
    Source/ProjectWalkingSim/Public/Interaction/InteractableInterface.h
    Source/ProjectWalkingSim/Private/Interaction/InteractableInterface.cpp
    Source/ProjectWalkingSim/Public/Interaction/HideableInterface.h
    Source/ProjectWalkingSim/Private/Interaction/HideableInterface.cpp
    Source/ProjectWalkingSim/Public/Interaction/SaveableInterface.h
    Source/ProjectWalkingSim/Private/Interaction/SaveableInterface.cpp
    Source/ProjectWalkingSim/Public/Tags/SereneTags.h
    Source/ProjectWalkingSim/Private/Tags/SereneTags.cpp
  </files>
  <action>
    1. Create IInteractable UINTERFACE (fully specified per RESEARCH.md Pattern 4):
       - UINTERFACE(MinimalAPI, Blueprintable) class UInteractable : public UInterface
       - IInteractable with PROJECTWALKINGSIM_API:
         - GetInteractionText() const -> FText (BlueprintNativeEvent)
         - CanInteract(AActor* Interactor) const -> bool (BlueprintNativeEvent)
         - OnInteract(AActor* Interactor) (BlueprintNativeEvent)
         - OnFocusBegin(AActor* Interactor) (BlueprintNativeEvent)
         - OnFocusEnd(AActor* Interactor) (BlueprintNativeEvent)
       - Cpp file: empty (no default implementations needed, Execute_ wrappers auto-generated)

    2. Create IHideable UINTERFACE (stub for Phase 3):
       - CanHide(AActor* HidingActor) const -> bool
       - OnEnterHiding(AActor* HidingActor)
       - OnExitHiding(AActor* HidingActor)
       - Cpp file: empty

    3. Create ISaveable UINTERFACE (stub for Phase 7):
       - GetSaveId() const -> FString
       - WriteSaveData() (empty params for now, will be expanded)
       - ReadSaveData() (empty params for now)
       - Cpp file: empty

    4. Create SereneTags.h/.cpp with native gameplay tags:
       - Include NativeGameplayTags.h
       - Namespace SereneTags:
         - Interaction tags: TAG_Interaction_Door, TAG_Interaction_Pickup, TAG_Interaction_Readable, TAG_Interaction_Drawer
         - Movement tags: TAG_Movement_Walking, TAG_Movement_Sprinting, TAG_Movement_Crouching
         - Player state tags: TAG_Player_Exhausted, TAG_Player_Leaning, TAG_Player_InTransition
       - Use UE_DECLARE_GAMEPLAY_TAG_EXTERN in header
       - Use UE_DEFINE_GAMEPLAY_TAG in cpp
       - Tag strings: "Interaction.Door", "Movement.Walking", etc.

    IMPORTANT: All UINTERFACE functions must be BlueprintNativeEvent and BlueprintCallable. Use UFUNCTION specifiers exactly as shown in RESEARCH.md. The cpp files for interfaces just need the #include for the header -- the GENERATED_BODY macro handles everything.
  </action>
  <verify>
    Project compiles successfully with all interfaces and tags:
    - Verify IInteractable can be #included from another file
    - Verify SereneTags::TAG_Interaction_Door is accessible
    - No linker errors from missing UE_DEFINE_GAMEPLAY_TAG definitions
  </verify>
  <done>
    Three UINTERFACE pairs compile. IInteractable has 5 methods. IHideable and ISaveable are stubs with placeholder methods. 11 native gameplay tags compile and are usable. All using LogSerene, not LogTemp.
  </done>
</task>

</tasks>

<verification>
1. Open project in Unreal Editor -- no compilation errors on load
2. In any future .cpp file, #include "Interaction/InteractableInterface.h" compiles
3. In any future .cpp file, #include "Tags/SereneTags.h" and using SereneTags::TAG_Interaction_Door compiles
4. Build.cs includes EnhancedInput, UMG, GameplayTags, PhysicsCore, Slate, SlateCore
5. SereneGameInstance loads and saves accessibility settings
</verification>

<success_criteria>
- Project compiles with zero errors and zero warnings related to new code
- All 3 interfaces declared and compilable
- All 11 gameplay tags declared and defined
- SereneGameInstance has head-bob toggle and crouch mode settings with persistence
- Directory structure matches RESEARCH.md recommended layout
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
