---
phase: 04-monster-ai-core
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs
  - ProjectWalkingSim.uproject
  - Source/ProjectWalkingSim/Public/AI/AITypes.h
  - Source/ProjectWalkingSim/Private/AI/AITypes.cpp
  - Source/ProjectWalkingSim/Public/Tags/SereneTags.h
  - Source/ProjectWalkingSim/Private/Tags/SereneTags.cpp
autonomous: true

must_haves:
  truths:
    - "Project compiles with AIModule, NavigationSystem, StateTreeModule, GameplayStateTreeModule dependencies"
    - "StateTree and GameplayStateTree plugins are enabled"
    - "EAlertLevel enum is available for AI components"
    - "AI gameplay tags exist for alert levels and stimulus types"
  artifacts:
    - path: "Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs"
      provides: "AI module dependencies"
      contains: "AIModule"
    - path: "ProjectWalkingSim.uproject"
      provides: "StateTree plugin enables"
      contains: "StateTree"
    - path: "Source/ProjectWalkingSim/Public/AI/AITypes.h"
      provides: "EAlertLevel enum and AI constants"
      contains: "EAlertLevel"
    - path: "Source/ProjectWalkingSim/Public/Tags/SereneTags.h"
      provides: "AI gameplay tags"
      contains: "TAG_AI_Alert_Patrol"
  key_links:
    - from: "ProjectWalkingSim.Build.cs"
      to: "AIModule + StateTreeModule"
      via: "PublicDependencyModuleNames"
      pattern: "AIModule.*StateTreeModule"
---

<objective>
Add AI module dependencies, enable State Tree plugins, create AI foundation types (EAlertLevel enum, AI constants), and add AI gameplay tags. This is the zero-dependency foundation that all other Phase 4 plans build on.

Purpose: Every subsequent AI plan needs these modules, types, and tags to compile.
Output: Build.cs with 4 new modules, .uproject with 2 plugins, AITypes.h/cpp, updated SereneTags.h/cpp.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-monster-ai-core/04-RESEARCH.md

@Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs
@ProjectWalkingSim.uproject
@Source/ProjectWalkingSim/Public/Tags/SereneTags.h
@Source/ProjectWalkingSim/Private/Tags/SereneTags.cpp
</context>

<tasks>

<task type="auto">
  <name>Task 1: Module dependencies and plugin enables</name>
  <files>
    Source/ProjectWalkingSim/ProjectWalkingSim.Build.cs
    ProjectWalkingSim.uproject
  </files>
  <action>
    1. In Build.cs, add four new modules to PublicDependencyModuleNames:
       - "AIModule"
       - "NavigationSystem"
       - "StateTreeModule"
       - "GameplayStateTreeModule"
       Keep existing modules. Add a comment separating the new AI modules.

    2. In ProjectWalkingSim.uproject, add two plugin entries to the Plugins array:
       - { "Name": "StateTree", "Enabled": true }
       - { "Name": "GameplayStateTree", "Enabled": true }
       Keep existing plugins (ModelingToolsEditorMode, EnhancedInput, PythonScriptPlugin).
  </action>
  <verify>Build the project with `UnrealBuildTool` or open in editor. No unresolved module errors.</verify>
  <done>Build.cs has 4 new AI modules. .uproject has StateTree and GameplayStateTree plugins enabled.</done>
</task>

<task type="auto">
  <name>Task 2: AI types and gameplay tags</name>
  <files>
    Source/ProjectWalkingSim/Public/AI/AITypes.h
    Source/ProjectWalkingSim/Private/AI/AITypes.cpp
    Source/ProjectWalkingSim/Public/Tags/SereneTags.h
    Source/ProjectWalkingSim/Private/Tags/SereneTags.cpp
  </files>
  <action>
    1. Create AITypes.h with:
       - EAlertLevel enum (BlueprintType): Patrol, Suspicious, Alert (with UMETA DisplayNames)
       - DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam for FOnAlertLevelChanged (EAlertLevel, NewLevel)
       - Namespace or struct for AI constants:
         - VisibilityThreshold = 0.3f (below this, player invisible to AI)
         - BaseSuspicionRate = 0.15f (per second at full visibility)
         - SuspicionDecayRate = 0.065f (~15 seconds from full)
         - SuspiciousThreshold = 0.4f
         - AlertThreshold = 0.8f
         - WendigoWalkSpeed = 150.0f (cm/s)
         - SightRange = 2500.0f (cm)
         - LoseSightRange = 3000.0f (cm)
         - SightHalfAngle = 45.0f (degrees, 90 total FOV)
         - HearingRange = 2000.0f (cm)
         - SprintNoiseRange = 2000.0f (cm)

    2. Create AITypes.cpp (minimal, just includes for delegate registration if needed).

    3. Add AI tags to SereneTags.h namespace (after existing hiding tags):
       - TAG_AI_Alert_Patrol ("AI.Alert.Patrol")
       - TAG_AI_Alert_Suspicious ("AI.Alert.Suspicious")
       - TAG_AI_Alert_Alert ("AI.Alert.Alert")
       - TAG_AI_Stimulus_Sight ("AI.Stimulus.Sight")
       - TAG_AI_Stimulus_Hearing ("AI.Stimulus.Hearing")

    4. Add matching UE_DEFINE_GAMEPLAY_TAG entries to SereneTags.cpp.

    Use project conventions: Copyright Null Lantern header, #pragma once, PROJECTWALKINGSIM_API on exported types.
  </action>
  <verify>Project compiles. `#include "AI/AITypes.h"` resolves. EAlertLevel::Patrol, SereneTags::TAG_AI_Alert_Patrol are usable.</verify>
  <done>AITypes.h has EAlertLevel enum + AI constants + FOnAlertLevelChanged delegate. SereneTags has 5 new AI tags.</done>
</task>

</tasks>

<verification>
- Project compiles cleanly with all new modules
- No warnings from new files
- EAlertLevel has 3 values: Patrol, Suspicious, Alert
- 5 new gameplay tags available in SereneTags namespace
- StateTree and GameplayStateTree plugins enabled in .uproject
</verification>

<success_criteria>
Project compiles with AIModule, NavigationSystem, StateTreeModule, and GameplayStateTreeModule. AITypes.h provides EAlertLevel enum and AI constants. SereneTags.h has 5 AI tags. Foundation ready for all subsequent Phase 4 plans.
</success_criteria>

<output>
After completion, create `.planning/phases/04-monster-ai-core/04-01-SUMMARY.md`
</output>
